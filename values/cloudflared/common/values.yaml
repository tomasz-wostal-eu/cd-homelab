# Cloudflare Tunnel (locally-managed) common configuration
# Ingress rules configured in values, DNS via External DNS

image:
  repository: cloudflare/cloudflared
  pullPolicy: IfNotPresent
  tag: "2024.8.3"

replicaCount: 1

# Credentials from ExternalSecret
cloudflare:
  secretName: cloudflared-credentials

podAnnotations:
  prometheus.io/scrape: "true"
  prometheus.io/port: "2000"
  prometheus.io/path: "/metrics"

resources:
  requests:
    cpu: 10m
    memory: 32Mi
  limits:
    cpu: 100m
    memory: 128Mi

# Pod-level security context
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 65532

# Container-level security context
securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL

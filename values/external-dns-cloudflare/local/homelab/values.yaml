# External DNS Cloudflare - homelab configuration

# Domain filters - add your Cloudflare managed domains
domainFilters:
  - "wostal.eu"
  - "devopslaboratory.org"

# Sources to watch for DNS records
# Note: gateway-httproute removed - use DNSEndpoint (crd) for Cloudflare Tunnel
# HTTPRoute generates records to Gateway IP, but tunnel needs CNAME to tunnel
sources:
  - service
  - ingress
  - crd

# Cloudflare provider
provider:
  name: cloudflare

# Enable Cloudflare proxy (orange cloud) for all records
# Required for Cloudflare Tunnel to work
extraArgs:
  - --cloudflare-proxied

# Sync policy - will create and delete records
policy: sync

# Cloudflare API token from ExternalSecret
env:
  - name: CF_API_TOKEN
    valueFrom:
      secretKeyRef:
        name: cloudflare-api-token
        key: cloudflare_api_token

# Log level
logLevel: info

# Interval between sync runs
interval: 1m

# TXT record owner ID
txtOwnerId: homelab
